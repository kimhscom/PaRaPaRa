<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="para.pao">
<!-- 	
	<resultMap id="member_hobby" type="com.happy.para.dto.PaoDto">
		<result property="PAO_STATUS.PS_NAME" column="PS_NAME" />
		<result property="STORE.STORE_NAME" column="STORE_NAME" />
		<result property="userName" column="user_name" />
		<result property="hobbyName" column="hobby_name" />
	</resultMap>

	  -->
	<!-- 매장 재고 조회 -->
	<!-- 
	<select id="stockList" parameterType="java.lang.String" resultType="java.util.List">
	SELECT STOCK_SEQ, STORE_CODE, STOCK_NAME, STOCK_QTY
	FROM STOCK
	WHERE STORE_CODE = #{store_code}
	ORDER BY STOCK_SEQ
	</select>
	 -->
	
	<!-- 업주 : 매장 발주 내역 조회 --> 
	<select id="paoList" parameterType="java.lang.String" resultType="PaoDto">
	SELECT PAO_SEQ, STORE_CODE, PS_CODE, PAO_DATE
	FROM PAO
	WHERE STORE_CODE = #{store_code}
	ORDER BY PAO_SEQ DESC
	</select>
	<!-- 
	<select id="paoList" parameterType="java.lang.String" resultType="PaoDto">
	SELECT PAO_SEQ, PAO_DATE, PAO_STATUS.PS_NAME AS 'PS_NAME', STORE.STORE_NAME AS 'STORE_NAME'
	FROM PAO JOIN STORE ON PAO.STORE_CODE=STORE.STORE_CODE
			JOIN PAO_STATUS ON PAO.PS_CODE=PAO_STATUS.PS_CODE
	WHERE PAO.STORE_CODE = #{store_code}
	ORDER BY PAO_SEQ DESC
	</select>
	 -->
	 
<!-- 	
	업주 : 지출 통계
	<select id="ownerStatsOutcome" parameterType="java.util.Map" resultType="java.lang.Integer">
	SELECT SUM(ITEM_PRICE*PI_QTY) 
			FROM (PAO JOIN PAO_ITEM ON PAO.PAO_SEQ=PAO_ITEM.PAO_SEQ) 
			JOIN ITEM ON PAO_ITEM.ITEM_SEQ=ITEM.ITEM_SEQ
			WHERE PAO.STORE_CODE=#{store_code} 
			AND (PAO_DATE BETWEEN #{start} AND #{end}) AND PS_CODE=3
	</select>
	
	업주 : 상위판매메뉴 통계
	<select id="ownerStatsMenu" parameterType="java.util.Map" resultType="RequestDto">
	SELECT REQUEST_MENU
 	FROM REQUEST
 	WHERE STORE_CODE=#{store_code} 
 	AND (REQUEST_TIME BETWEEN #{start} AND #{end}) AND OS_CODE=3
	</select>
	
	메뉴이름 찾기
	<select id="findMenuName" parameterType="java.lang.String" resultType="java.lang.String">
	SELECT MENU_NAME FROM MENU WHERE MENU_SEQ=#{menu_seq} AND (MENU_CATEGORY='주메뉴' OR MENU_CATEGORY='사이드메뉴')
	</select>
	
	관리자,담당자 : 수익통계
	<select id="adminStatsIncome" parameterType="java.util.Map" resultType="java.lang.Integer">
	SELECT SUM(REQUEST_PRICE)
	FROM (SELECT REQUEST_PRICE
 			FROM REQUEST
 			WHERE STORE_CODE IN 
 			<foreach item="store_code" collection="store_code_"
      		open="(" separator="," close=")">
        		#{store_code}
 			</foreach>
 			AND (REQUEST_TIME BETWEEN #{start} AND #{end}) AND OS_CODE=3)
	</select>
	
	관리자,담당자 : 상위판매메뉴 통계
	<select id="adminStatsMenu" parameterType="java.util.Map" resultType="RequestDto">
	SELECT REQUEST_MENU 
	FROM REQUEST 
	WHERE STORE_CODE IN 
	<foreach item="store_code" collection="store_code_"
      open="(" separator="," close=")">
        	#{store_code}
 	</foreach>
	AND (REQUEST_TIME BETWEEN #{start} AND #{end}) AND OS_CODE=3
	</select>
 -->	 
</mapper>
